@using RASolarAMS.Model;
@{
    ViewBag.Title = "Monthly Accounting Summary Statement";


    Layout = "~/Areas/Financial/Views/Shared/_AccountingLayout.cshtml";

    if (false)
    {
    <script src="../../../../Scripts/jquery-1.5.1.min.js" type="text/javascript"></script>
    <script src="../../../../Scripts/RASolarCustomFunction.js" type="text/javascript"></script>   
    }
}
@section TopMenu
{
    @Html.Partial((String)ViewBag.TopMenu)
}
@section LoginInfo
{
    <table cellpadding="0" cellspacing="0" border="0" style="text-align: right;" width="100%">
        <tr>
            <td style="width: 20%" align="left">
                @ViewBag.ZoneTitle&nbsp; @ViewBag.ZoneName
            </td>
            <td style="width: 20%" align="left">
                @ViewBag.RegionTitle&nbsp; @ViewBag.RegionName
            </td>
            <td style="width: 20%" align="left">
                @ViewBag.UnitTitle&nbsp; @ViewBag.UnitName
            </td>
            <td style="width: 40%" align="left">
                @ViewBag.OpenMonthYear
            </td>
        </tr>
    </table>
}
@{
    MonthlyAccountingSummaryStatement objMonthlyAccountingSummary = new MonthlyAccountingSummaryStatement();
    objMonthlyAccountingSummary = (MonthlyAccountingSummaryStatement)ViewBag.AccountingSummary;    
}
<table class="IDCOLTable" width="100%" cellspacing="1" cellpadding="0">
    <tr>
        <td colspan="7" class="IDCOLHeader" align="left">
            Sales Summary
        </td>
    </tr>
    <tr>
        <td colspan="2">
            <strong>Project - Solar IDCOL</strong>
        </td>
        <td colspan="2">
            <table width="100%" cellspacing="0" cellpadding="0">
                <tr>
                    <td align="center" valign="top">
                        <strong>No of Sales(Qty)</strong>
                    </td>
                    <td align="center">
                        <strong>Amount (Tk)</strong>
                    </td>
                </tr>
                <tr>
                    <td align="right">
                        @Html.Label("lblSalesQuantitySHS", Convert.ToDecimal(objMonthlyAccountingSummary.SalesQuantitySHS).ToString("#,###."))
                    </td>
                    <td align="right">
                        &nbsp; @objMonthlyAccountingSummary.SalesAmountSHS.ToString("#,###.")
                    </td>
                </tr>
            </table>
        </td>
        <td>
            <strong>Project - Biogas</strong>
        </td>
        <td colspan="2" valign="top">
            <table class="IDCOLTable" width="100%" cellspacing="0" cellpadding="0">
                <tr>
                    <td align="center">
                        <strong>No of Sales (Qty)</strong>
                    </td>
                    <td align="center">
                        <strong>Amount (Tk)</strong>
                    </td>
                </tr>
                <tr>
                    <td align="right">
                        @Html.Label("lblSalesQuantityBioGAS", objMonthlyAccountingSummary.SalesQuantityBioGAS.ToString("#,###."))
                    </td>
                    <td align="right">
                        @Html.Label("lblSalesAmountBioGAS", Convert.ToDecimal(objMonthlyAccountingSummary.SalesAmountBioGAS).ToString("#,###."))
                    </td>
                </tr>
            </table>
        </td>
    </tr>
</table>
<table class="IDCOLTable" width="100%" cellspacing="1" cellpadding="0">
    <tr>
        <td colspan="8" align="left" class="IDCOLHeader">
            Cash Summary
        </td>
    </tr>
    <tr>
        <td colspan="7" align="left" style="background-color: #61B3FA">
            <strong>A. Opening Cash Balance (Beginning of Month)</strong>
        </td>
        <td align="right" style="background-color: #61B3FA">
            <strong>@Html.Label("lblCashInHandOpeningBalance", Convert.ToDecimal(objMonthlyAccountingSummary.CashInHandOpeningBalance).ToString("#,###."))</strong>
        </td>
    </tr>
    <tr>
        <td align="center">
            <strong>Collection</strong>
        </td>
        <td align="center">
            <strong>Down Payment</strong>
        </td>
        <td align="center">
            <strong>Principal</strong>
        </td>
        <td align="center">
            <strong>Service Charge</strong>
        </td>
        <td align="center">
            <strong>Advance /<br />
                Technical Fee</strong>
        </td>
        <td align="center">
            <strong>Spare Parts</strong>
        </td>
        <td align="center">
            <strong>Collection
                <br />
                Reconcilation</strong>
        </td>
        <td align="center">
            <strong>Total</strong>
        </td>
    </tr>
    <tr>
        <td align="left">
            Project - Solar IDCOL
        </td>
        <td align="right">
            &nbsp; @Convert.ToDecimal(objMonthlyAccountingSummary.CollectionDPSHS).ToString("#,###.")
        </td>
        <td align="right">
            &nbsp; @Html.Label("lblCollectionPrincipalSHS", Convert.ToDecimal(objMonthlyAccountingSummary.CollectionPrincipalSHS).ToString("#,###."))
        </td>
        <td align="right">
            &nbsp; @Html.Label("lblCollectionServiceChrgeSHS", Convert.ToDecimal(objMonthlyAccountingSummary.CollectionServiceChrgeSHS).ToString("#,###."))
        </td>
        <td align="right">
            &nbsp; @Convert.ToDecimal(objMonthlyAccountingSummary.CollectionAsAdvanceSHS).ToString("#,###.")
        </td>
        <td align="right">
            &nbsp; @objMonthlyAccountingSummary.CollectionSparePartsSHS.ToString("#,###.")
        </td>
        @* <td align="right">
            &nbsp; @objMonthlyAccountingSummary.CollectionServiceChrgeBioGAS.ToString("#,###.")
        </td>*@
        <td align="right">
            <strong style="color: Red">&nbsp;@Convert.ToDecimal(objMonthlyAccountingSummary.CollectionReconSHS).ToString("#,###.")</strong>
        </td>
        <td align="right">
            &nbsp; @Html.Label(Convert.ToDecimal(objMonthlyAccountingSummary.CollectionTotalSHS).ToString("#,###."))
        </td>
    </tr>
    <tr>
        <td align="left">
            Project - Biogas
        </td>
        <td align="right">
            &nbsp; @objMonthlyAccountingSummary.CollectionDPBioGAS.ToString("#,###.")
        </td>
        <td align="right">
            &nbsp; @objMonthlyAccountingSummary.CollectionPrincipalBioGAS.ToString("#,###.")
        </td>
        <td align="right">
            &nbsp; @objMonthlyAccountingSummary.CollectionServiceChrgeBioGAS.ToString("#,###.")
        </td>
        <td align="right">
            &nbsp; @objMonthlyAccountingSummary.CollectionAsAdvanceBioGAS.ToString("#,###.")
            @*  Technical Fee Biogas Hobe *@
        </td>
        <td align="right">
            &nbsp; @objMonthlyAccountingSummary.CollectionSparePartsBioGAS.ToString("#,###.")
        </td>
        <td align="right">
            <strong style="color: Red">&nbsp; @objMonthlyAccountingSummary.CollectionReconBioGAS.ToString("#,###.")</strong>
        </td>
        <td align="right">
            &nbsp; @Html.Label(Convert.ToDecimal(objMonthlyAccountingSummary.CollectionTotalBioGAS).ToString("#,###."))
        </td>
    </tr>
    <tr>
        <td colspan="7" align="left">
            Notice Pay Salary (Salary exp.)
        </td>
        <td align="right">
            &nbsp; @objMonthlyAccountingSummary.NoticePaySalary.ToString("#,###.")
        </td>
    </tr>
    <tr>
        <td colspan="7" align="left">
            Audit Claim Receivable
        </td>
        <td align="right">
            &nbsp; @objMonthlyAccountingSummary.AuditClaimReceivable.ToString("#,###.")
        </td>
    </tr>
    <tr>
        <td colspan="7" align="left">
            Others Income
        </td>
        <td align="right">
            &nbsp; @objMonthlyAccountingSummary.OthersIncome.ToString("#,###.")
        </td>
    </tr>
    <tr>
        <td colspan="7" align="left" style="background-color: #61B3FA">
            <strong>B. Cash Inflow During This Period</strong>
        </td>
        <td align="right" style="background-color: #61B3FA">
            &nbsp; <strong>@Html.Label("lblTotalCashInflowInThisPeriod", Convert.ToDecimal(objMonthlyAccountingSummary.TotalCashInflowInThisPeriod).ToString("#,###."))
            </strong>
        </td>
    </tr>
    <tr>
        <td colspan="8">
            &nbsp;
        </td>
    </tr>
    <tr>
        <td align="left">
            <strong>Cash Payment</strong>
        </td>
        <td align="center" colspan="2">
            <strong>Bank Deposit</strong>
        </td>
        <td align="center">
            <strong>Online Transfer</strong>
        </td>
        <td align="center">
            <strong>Inter Unit Transfer</strong>
        </td>
        <td align="center">
            <strong>Monthly Expenses</strong>
        </td>
        <td colspan="2" align="center">
            <strong>Cash Outflow</strong>
        </td>
    </tr>
    <tr>
        <td align="left">
            Project - Solar IDCOL
        </td>
        <td align="right" colspan="2">
            &nbsp; @objMonthlyAccountingSummary.BankDeposit.ToString("#,###.")
        </td>
        <td align="right">
            &nbsp; @objMonthlyAccountingSummary.OnlineTransfer.ToString("#,###.")
        </td>
        <td align="right">
            &nbsp; @objMonthlyAccountingSummary.InterUnitTransfer.ToString("#,###.")
        </td>
        <td align="right">
            <a href="@(@Url.Action("UnitWiseMonthyExpense", "AccountingReport") + "?unitCode=")@(@ViewBag.LocationCode + "&projectCode=100200")" target="_blank">@objMonthlyAccountingSummary.MonthlyExpensesSHS.ToString("#,###.")
            </a>
        </td>
        <td colspan="2" align="right">
            @Html.Label(Convert.ToDecimal(objMonthlyAccountingSummary.TotalCashOutflowSHS).ToString("#,###."))
        </td>
    </tr>
    <tr>
        <td align="left">
            Project - Biogas
        </td>
        <td colspan="2">
            &nbsp;
        </td>
        <td>
            &nbsp;
        </td>
        <td>
            &nbsp;
        </td>
        <td align="right">
            &nbsp;<a href="@(@Url.Action("UnitWiseMonthyExpense", "AccountingReport") + "?unitCode=")@(@ViewBag.LocationCode + "&projectCode=100500")" target="_blank">@objMonthlyAccountingSummary.TotalCashOutflowBioGAS.ToString("#,###.")
            </a>
        </td>
        <td colspan="2" align="right">
            @Html.Label(Convert.ToDecimal(objMonthlyAccountingSummary.TotalCashOutflowBioGAS).ToString("#,###."))
        </td>
    </tr>
    <tr>
        <td colspan="7" align="left" style="background-color: #61B3FA">
            <strong>C. Cash Outflow During This Period</strong>
        </td>
        <td colspan="1" align="right" style="background-color: #61B3FA">
            &nbsp; <strong>@Html.Label(Convert.ToDecimal(objMonthlyAccountingSummary.TotalCashOutflowInThisPeriod).ToString("#,###."))
            </strong>
        </td>
    </tr>
    <tr>
        <td colspan="8">
            &nbsp;
        </td>
    </tr>
    <tr>
        <td colspan="4" align="left">
            &nbsp;
        </td>
        <td align="center">
            <strong>Difference(Y-Z)</strong>
        </td>
        <td align="center">
            <strong>Y. Closing Cash Balance
                <br />
                (End Of Month)</strong>
        </td>
        <td colspan="2" align="center">
            <strong>Z. Closing Cash Balance
                <br />
                (Calculative [A+B-C])</strong>
        </td>
    </tr>
    <tr>
        <td colspan="4" align="left">
            <strong>Closing Cash Balance (End of Month)</strong>
        </td>
        <td align="right">
            <strong style="color: Red">@Html.Label("lblDifferenceInActualVsCalculativeCashInHand", Convert.ToDecimal(objMonthlyAccountingSummary.DifferenceInActualVsCalculativeCashInHand).ToString("#,###."))
            </strong>
        </td>
        <td align="right">
            &nbsp; @objMonthlyAccountingSummary.CashInHandClosingBalance.ToString("#,###.")
        </td>
        <td colspan="2" align="right">
            &nbsp; @Html.Label("lblCashInHandClosingBalanceCalculative", Convert.ToDecimal(objMonthlyAccountingSummary.CashInHandClosingBalanceCalculative).ToString("#,###."))
        </td>
    </tr>
</table>
<table class="IDCOLTable" width="100%" cellspacing="1" cellpadding="0">
    <tr>
        <td colspan="7" align="left" class="IDCOLHeader">
            Bank Summary
        </td>
    </tr>
    <tr>
        <td colspan="2" align="center">
            <strong>Opening Bank Balance
                <br />
                (Begining of Month)</strong>
        </td>
        <td align="center">
            <strong>Cash Deposit</strong>
        </td>
        <td align="center">
            <strong>TT/DD</strong>
        </td>
        <td align="center">
            <strong>Salary, Bonus, TA/DA</strong>
        </td>
        <td align="center">
            <strong>Bank Charge</strong>
        </td>
        <td align="center">
            <strong>Closing Bank Balance<br />
                (End of Month)</strong>
        </td>
    </tr>
    <tr>
        <td colspan="2" align="right">
            &nbsp; @Html.Label("lblCashAtBankOpeningBalance", Convert.ToDecimal(objMonthlyAccountingSummary.CashAtBankOpeningBalance).ToString("#,###."))
        </td>
        <td align="right">
            &nbsp; @objMonthlyAccountingSummary.CashDeposit.ToString("#,###.")
        </td>
        <td align="right">
            &nbsp; @objMonthlyAccountingSummary.TTnDD.ToString("#,###.")
        </td>
        <td align="right">
            &nbsp; @objMonthlyAccountingSummary.SalaryPayable.ToString("#,###.")
        </td>
        <td align="right">
            &nbsp; @objMonthlyAccountingSummary.BankCharge.ToString("#,###.")
        </td>
        <td align="right">
            &nbsp; @objMonthlyAccountingSummary.CashAtBankClosingBalance.ToString("#,###.")
        </td>
    </tr>
</table>
<script type="text/javascript">
    function RSFMenu(goFor) {
        window.location.replace(Helper.Menu("../../", goFor));
        return false;
    } 
</script>
