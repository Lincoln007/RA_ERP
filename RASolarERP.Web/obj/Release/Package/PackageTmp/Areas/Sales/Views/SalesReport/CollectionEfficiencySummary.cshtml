@model IEnumerable<RASolarERP.Model.CollectionEfficiencyByUnitOfficeSummary>
@{
    ViewBag.Title = "Collection Efficiency Summary";


    Layout = "~/Areas/Sales/Views/Shared/_SalesLayout.cshtml";
    if (false)
    {
    <script src="../../../../Scripts/jquery-1.5.1.min.js" type="text/javascript"></script>
    <script src="../../../../Scripts/RASolarCustomFunction.js" type="text/javascript"></script>    
    }
}
@section TopMenu
{
    @Html.Partial((String)ViewBag.TopMenu)
}
@section LoginInfo
{
    <table cellpadding="0" cellspacing="0" border="0" style="text-align: right;" width="100%">
        <tr>
            <td style="width: 20%" align="left">
                @ViewBag.LocationTitle&nbsp; @ViewBag.Location
            </td>
            <td style="width: 20%" align="left">
                @ViewBag.ZoneTitle&nbsp; @ViewBag.ZoneName
            </td>
            <td style="width: 20%" align="left">
                @ViewBag.RegionTitle&nbsp; @ViewBag.RegionName
            </td>
            <td style="width: 40%" align="left">
                @ViewBag.UnitTitle&nbsp; @ViewBag.UnitName
            </td>
        </tr>
    </table>
}
<div class="DataGridXScroll">
    @(Html.Telerik().Grid(Model)
                .Name("grvCollectionEfficiencySummary")
                .DataKeys(keys => keys.Add(k => k.Unit_Code))
                .Columns(column =>
                {

                    column.Bound(s => s.Zone_Name).Width(100).Hidden(true)
                    .GroupHeaderTemplate(@<text>Zone: @item.Key </text>);

                    column.Bound(s => s.Region_Name).Width(100).Hidden(true)
                    .GroupHeaderTemplate(@<text>Region: @item.Key </text>);

                    column.Bound(s => s.Unit_Code).Width(100);
                    column.Bound(s => s.Unit_Name).Width(100)
                    .GroupFooterTemplate(@<text> Total </text>);

                    column.Bound(s => s.CM_Receivable__One_Installment__4).Width(160).HtmlAttributes(new { @class = "GridColumnRightAlign" })
                    .Aggregate(aggreages => aggreages.Sum())
                    .Format("{0:0}")
                    .FooterTemplate(@<text> @item.Sum.Format("{0:0}") </text>)
                    .GroupFooterTemplate(@<text>@item.Sum.Format("{0:0}")</text>);

                    column.Bound(s => s.CM_CashCollection_5).Width(130).HtmlAttributes(new { @class = "GridColumnRightAlign" })
                      .Aggregate(aggreages => aggreages.Sum())
                .Format("{0:0}")
                .FooterTemplate(@<text> @item.Sum.Format("{0:0}") </text>)
                .GroupFooterTemplate(@<text>@item.Sum.Format("{0:0}")</text>);

                    column.Bound(s => s.CM_SystemReturn_6).Width(130).HtmlAttributes(new { @class = "GridColumnRightAlign" })
                      .Aggregate(aggreages => aggreages.Sum())
                .Format("{0:0}")
                .FooterTemplate(@<text> @item.Sum.Format("{0:0}") </text>)
                .GroupFooterTemplate(@<text>@item.Sum.Format("{0:0}")</text>);

                    column.Bound(s => s.CM_AdvanceAdjustment_7).Width(130).HtmlAttributes(new { @class = "GridColumnRightAlign" })
                      .Aggregate(aggreages => aggreages.Sum())
                .Format("{0:0}")
                .FooterTemplate(@<text> @item.Sum.Format("{0:0}") </text>)
                .GroupFooterTemplate(@<text>@item.Sum.Format("{0:0}")</text>);

                    column.Bound(s => s.CM_TotalCollection_8_5_6_7).Width(150).HtmlAttributes(new { @class = "GridColumnRightAlign" })
                    .Aggregate(aggreages => aggreages.Sum())
                    .Format("{0:0}")
                    .FooterTemplate(@<text> @item.Sum.Format("{0:0}") </text>)
                    .GroupFooterTemplate(@<text>@item.Sum.Format("{0:0}")</text>);

                    column.Bound(s => s.CM_CollectionEfficiency_9_8_4_).Width(160).HtmlAttributes(new { @class = "GridColumnRightAlign" })
                   .Format("{0:N}")
                   .FooterTemplate(@<p id="CM_CollectionEfficiency_9_8_4">@ViewBag.CMCollectionEfficiency</p>);

                    column.Bound(s => s.OD_OverdueInCurrentMonth_10_4_8).Width(160).HtmlAttributes(new { @class = "GridColumnRightAlign" })
                .Aggregate(aggreages => aggreages.Sum())
                .Format("{0:0}")
                .FooterTemplate(@<text> @item.Sum.Format("{0:0}") </text>)
                .GroupFooterTemplate(@<text>@item.Sum.Format("{0:0}")</text>);

                    column.Bound(s => s.OD_OverdueBalanceAtTheEndOfLastMonth_11).Width(180).HtmlAttributes(new { @class = "GridColumnRightAlign" })
                          .Aggregate(aggreages => aggreages.Sum())
                .Format("{0:0}")
                .FooterTemplate(@<text> @item.Sum.Format("{0:0}") </text>)
                .GroupFooterTemplate(@<text>@item.Sum.Format("{0:0}")</text>);

                    column.Bound(s => s.OD_TotalOverdueUpToCurrentMonth_12_10_11).Width(200).HtmlAttributes(new { @class = "GridColumnRightAlign" })
                          .Aggregate(aggreages => aggreages.Sum())
                .Format("{0:0}")
                .FooterTemplate(@<text> @item.Sum.Format("{0:0}") </text>)
                .GroupFooterTemplate(@<text>@item.Sum.Format("{0:0}")</text>);

                    column.Bound(s => s.OD_RecoveryFromOverdueInCurrentMonth_13).Width(180).HtmlAttributes(new { @class = "GridColumnRightAlign" })
                          .Aggregate(aggreages => aggreages.Sum())
                .Format("{0:0}")
                .FooterTemplate(@<text> @item.Sum.Format("{0:0}") </text>)
                .GroupFooterTemplate(@<text>@item.Sum.Format("{0:0}")</text>);

                    column.Bound(s => s.OD_SystemReturn_14).Width(130).HtmlAttributes(new { @class = "GridColumnRightAlign" })
                          .Aggregate(aggreages => aggreages.Sum())
                .Format("{0:0}")
                .FooterTemplate(@<text> @item.Sum.Format("{0:0}") </text>)
                .GroupFooterTemplate(@<text>@item.Sum.Format("{0:0}")</text>);

                    column.Bound(s => s.OD_OverdueBalanceAtTheEndOfCurrentMonth_15_12_13_14).Width(200).HtmlAttributes(new { @class = "GridColumnRightAlign" })
                          .Aggregate(aggreages => aggreages.Sum())
                .Format("{0:0}")
                .FooterTemplate(@<text> @item.Sum.Format("{0:0}") </text>)
                .GroupFooterTemplate(@<text>@item.Sum.Format("{0:0}")</text>);

                    column.Bound(s => s.OverallCollectionEfficiency_16__8_13_14___4_11__).Width(200).HtmlAttributes(new { @class = "GridColumnRightAlign" })                    
                    .Format("{0:N}")
                    .FooterTemplate(@<p id="OverallCollectionEfficiency_16__8_13_14___4_11">@ViewBag.OverallCollectionEfficiency_16_8_13_14_4_11</p>);

                    column.Bound(s => s.AD_AdvanceBalanceAtTheEndOfLastMonth_17).Width(180).HtmlAttributes(new { @class = "GridColumnRightAlign" })
                    .Aggregate(aggreages => aggreages.Sum())
                    .Format("{0:0}")
                    .FooterTemplate(@<text> @item.Sum.Format("{0:0}") </text>)
                    .GroupFooterTemplate(@<text>@item.Sum.Format("{0:0}")</text>);

                    column.Bound(s => s.AD_AdvanceReceivedInCurrentMonth_18).Width(200).HtmlAttributes(new { @class = "GridColumnRightAlign" })
                          .Aggregate(aggreages => aggreages.Sum())
                .Format("{0:0}")
                .FooterTemplate(@<text> @item.Sum.Format("{0:0}") </text>)
                .GroupFooterTemplate(@<text>@item.Sum.Format("{0:0}")</text>);

                    column.Bound(s => s.AD_TotalAdvance_19_17_18).Width(170).HtmlAttributes(new { @class = "GridColumnRightAlign" })
                          .Aggregate(aggreages => aggreages.Sum())
                .Format("{0:0}")
                .FooterTemplate(@<text> @item.Sum.Format("{0:0}") </text>)
                .GroupFooterTemplate(@<text>@item.Sum.Format("{0:0}")</text>);

                    column.Bound(s => s.AD_AdvanceAdjustmentInCurrentMonth_20).Width(160).HtmlAttributes(new { @class = "GridColumnRightAlign" })
                          .Aggregate(aggreages => aggreages.Sum())
                .Format("{0:0}")
                .FooterTemplate(@<text> @item.Sum.Format("{0:0}") </text>)
                .GroupFooterTemplate(@<text>@item.Sum.Format("{0:0}")</text>);

                    column.Bound(s => s.AD_SystemReturn_21).Width(160).HtmlAttributes(new { @class = "GridColumnRightAlign" })
                          .Aggregate(aggreages => aggreages.Sum())
                .Format("{0:0}")
                .FooterTemplate(@<text> @item.Sum.Format("{0:0}") </text>)
                .GroupFooterTemplate(@<text>@item.Sum.Format("{0:0}")</text>);

                    column.Bound(s => s.AD_AdvanceBalanceAfterAdjustment_22_19_20_21).Width(190).HtmlAttributes(new { @class = "GridColumnRightAlign" })
                          .Aggregate(aggreages => aggreages.Sum())
                .Format("{0:0}")
                .FooterTemplate(@<text> @item.Sum.Format("{0:0}") </text>)
                .GroupFooterTemplate(@<text>@item.Sum.Format("{0:0}")</text>);

                }).Groupable(settings => settings.Groups(group =>
                {

                    group.Add(g => g.Zone_Name);
                    group.Add(g => g.Region_Name);

                }).Visible(false))
                .Scrollable(scroll => scroll.Height(300))

)
</div>
<script type="text/javascript">

    function RSFMenu(goFor) {
        window.location.replace(Helper.Menu("../../", goFor));
        return false;
    } 
 

</script>
